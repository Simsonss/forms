<!DOCTYPE html>
<form class="cf" >
    <link href="style.css" rel="stylesheet">
    <h1>Report a problem</h1>
    <div><div class="half left cf">
      <label for="name">Name:</label>
      <input name="name"type="text" id="input-name" placeholder="Name">
      <label for="name">issue Type:</label>
      <select id="issue-type" name="issueTypes">
                <option value="Task">Task</option>
                <option value="Story">Story</option>
                <option value="Bug">Bug</option>
                <option value="Epic">Epic</option>
                <option value="New Project">New Project</option>
       </select>
      <label for="name">Subject:</label>
      <input name="subject" type="text" id="input-subject"          
  placeholder="Subject">
    </div>
    <div class="half right cf">
      <label for="name">Description:</label>
      <textarea name="description" type="text" id="input-message"
  placeholder="Description"></textarea>
    </div>
      </div>
    <button type="submit"  id="input-submit">Submit</button>
    <link href="style.css" rel="stylesheet">
  </form>

  <script>
    const formEl = document.querySelector('.cf');

    formEl.addEventListener('submit',event =>{
        event.preventDefault();
        const formData = new FormData(formEl);
        const str = JSON.stringify(Object.fromEntries(formData));
        const jsons = JSON.parse(str);
        const test = `{"name": "${jsons.name}","issueTypes": "${jsons.issueTypes}","subject": "${jsons.subject}","description": "${jsons.description}"}`
        const datas = `{
        "fields": {
        "project": {"id": "10010"},
        "summary": "${jsons.subject}",
        "issuetype": {"name": "${jsons.issueTypes}"},
        "description": {
                "version": 1,
                "type": "doc",
                "content": [
                    {
                        "type": "paragraph",
                        "content": [
                            {
                                "type": "text",
                                "text": "${jsons.description}"
                            }
                        ]
                    }
                ]
            }
        }
    }`;
    // console.log(jsons);
    // fetch('https://gotdevops.atlassian.net/rest/api/3/issue', {
    //     method: 'POST',
    //     headers: {
    //     //   'Authorization': `Basic ${env.JIRATOKEN}`,
    //     'Authorization': `Basic c2F3cmF3aXQuc0BnbWFpbC5jb206QVRBVFQzeEZmR0YwaFRtVnc1WWxNR0RYcm5rYUNZZHlYQXprcHlYSk52d29CaXlMbjdhenNQcEhXRG40eU5lMWpwQ1M2V1RYOEt0RWMyd2s0b1Z6UXpZVjNCakdqU3oyb3dYUVl0R2pRdW1CaHEzZm5HTDdfNFdrNmdDYS1hTFVJTmJST0hpWlBnNkRYQjZ6V2I3WFFnVzVkTmVnT0NOd0NtV0hNS3JvQTFUM2ZwX1k0a2x5S09zPUJGOEY3MTJF`,
    //       'Accept': 'application/json',
    //       'Content-Type': 'application/json'
    //     },
    //     body: datas
    //   })
    //     .then(response => {
    //       console.log(
    //         `Response: ${response.status} ${response.statusText}`
    //       );
    //       return response.json();
    //     })
    //     .then(text => console.log(text))
    //     .catch(err => console.error(err));

        fetch('http://localhost:4008/jira',{
            method: 'POST',
            headers:{
              'Accept': 'application/json',
              'Content-Type': 'application/json'
            },
            body: test
        }).then(res => res.json())
          .catch(error => console.log(error));
 

    });
  

  </script>
